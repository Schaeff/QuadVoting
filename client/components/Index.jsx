let {Input, Col} = ReactBootstrap;

Index = React.createClass({

	getInitialState: function() {
		return {
			field: ''
		};
	},

	onFieldChange(event) {
		this.setState({
			field: event.target.value
		});
	},

	onCreateOrganization(event) {

		let {field} = this.state;

		event.preventDefault();

		Organization.new(field, {
			data: '606060405260646006600050556000600760005055604051611983380380611983833981016040528080518201919060200150505b33600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908302179055506000600560005081905550600060046000508190555080600a6000509080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106100c457805160ff19168380011785556100f5565b828001600101855582156100f5579182015b828111156100f45782518260005055916020019190600101906100d6565b5b5090506101209190610102565b8082111561011c5760008181506000905550600101610102565b5090565b50505b50611851806101326000396000f360606040523615610103576000357c010000000000000000000000000000000000000000000000000000000090048063013cf08b1461010557806306fdde031461014757806308ae4b0c146101c257806308d103f7146101ee5780630b1ca49a1461021a5780631cdc044b1461023257806323b161ab1461025557806327e235e3146102785780632d87017c146102a4578063400e3949146102c7578063446a37e0146102ea5780634698d11014610302578063612032651461032557806361ebccfd1461035e578063790b71331461038857806383197ef0146103a9578063c34c356f146103b8578063ca6d56dc146103d0578063d8af4d0e146103e857610103565b005b61011b60048080359060200190919050506104fe565b604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b6101546004805050610540565b60405180806020018281038252838181518152602001915080519060200190808383829060006004602084601f0104600f02600301f150905090810190601f1680156101b45780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6101d86004808035906020019091905050610476565b6040518082815260200191505060405180910390f35b61020460048080359060200190919050506104b6565b6040518082815260200191505060405180910390f35b61023060048080359060200190919050506108da565b005b61023f60048050506104e3565b6040518082815260200191505060405180910390f35b61026260048050506104da565b6040518082815260200191505060405180910390f35b61028e600480803590602001909190505061049b565b6040518082815260200191505060405180910390f35b6102b160048050506104ec565b6040518082815260200191505060405180910390f35b6102d460048050506104f5565b6040518082815260200191505060405180910390f35b6103006004808035906020019091905050610ef7565b005b61030f60048050506104d1565b6040518082815260200191505060405180910390f35b6103326004805050610450565b604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b6103866004808035906020019091908035906020019091908035906020019091905050610a9d565b005b6103a76004808035906020019091908035906020019091905050610a4a565b005b6103b66004805050611066565b005b6103ce6004808035906020019091905050610cdb565b005b6103e660048080359060200190919050506107df565b005b61044e6004808035906020019082018035906020019191908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509090919080359060200190919080359060200190919050506105e1565b005b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600160005060205280600052604060002060009150909054906101000a900460ff1681565b60026000506020528060005260406000206000915090505481565b60036000506020528060005260406000206000915090505481565b60046000505481565b60056000505481565b60066000505481565b60076000505481565b60086000505481565b600960005081815481101561000257906000526020600020900160005b9150909054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600a6000508054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156105d95780601f106105ae576101008083540402835291602001916105d9565b820191906000526020600020905b8154815290600101906020018083116105bc57829003601f168201915b505050505081565b6000600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614151561063f576107d9565b6007600050544201831015610653576107d9565b838383604051610757806110fa83390180806020018481526020018381526020018281038252858181518152602001915080519060200190808383829060006004602084601f0104600f02600301f150905090810190601f1680156106cc5780820380516001836020036101000a031916815260200191505b50945050505050604051809103906000f0905060096000508054806001018281815481835581811511610731578183600052602060002091820191016107309190610712565b8082111561072c5760008181506000905550600101610712565b5090565b5b5050509190906000526020600020900160005b83909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908302179055505060086000818150548092919060010191905055507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff600360005060008373ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600050819055505b50505050565b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614151561083b576108d7565b6001600160005060008373ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083021790555060046000818150548092919060010191905055506000600260005060008373ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600050819055506108d660066000505482610a4a565b5b50565b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614158061096e5750600160005060008273ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16155b1561097857610a47565b6000600160005060008373ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff02191690830217905550600460008181505480929190600190039190505550600260005060008273ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000505460056000828282505403925050819055506000600260005060008373ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600050819055505b50565b81600560008282825054019250508190555081600260005060008373ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828282505401925050819055505b5050565b6000600160005060003373ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff161515610ae457610cd5565b6001600260005060003373ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600050541015610b2157610cd5565b6001831015610b2f57610cd5565b600260005060003373ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600050548384021115610b6d57610cd5565b8190508073ffffffffffffffffffffffffffffffffffffffff166309eef43e33604051827c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1681526020019150506020604051808303816000876161da5a03f115610002575050506040518051906020015015610c0357610cd5565b828302600260005060003373ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828282505403925050819055508073ffffffffffffffffffffffffffffffffffffffff166361ebccfd858533604051847c0100000000000000000000000000000000000000000000000000000000028152600401808481526020018381526020018273ffffffffffffffffffffffffffffffffffffffff16815260200193505050506000604051808303816000876161da5a03f11561000257505050610cd5565b50505050565b60006000829150600090505b8173ffffffffffffffffffffffffffffffffffffffff1663bfcddbbc604051817c01000000000000000000000000000000000000000000000000000000000281526004018090506020604051808303816000876161da5a03f11561000257505050604051805190602001508160ff161015610ef1578173ffffffffffffffffffffffffffffffffffffffff1663bfcddbbc604051817c01000000000000000000000000000000000000000000000000000000000281526004018090506020604051808303816000876161da5a03f11561000257505050604051805190602001508273ffffffffffffffffffffffffffffffffffffffff16633d79d1c8604051817c01000000000000000000000000000000000000000000000000000000000281526004018090506020604051808303816000876161da5a03f115610002575050506040518051906020015004600260005060008473ffffffffffffffffffffffffffffffffffffffff1663da58c7d985604051827c0100000000000000000000000000000000000000000000000000000000028152600401808260ff1681526020019150506020604051808303816000876161da5a03f115610002575050506040518051906020015073ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828282505401925050819055505b8080600101915050610ce7565b5b505050565b60007fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff600360005060008473ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060005054141515610f5657611062565b8190508073ffffffffffffffffffffffffffffffffffffffff166394f0873d604051817c01000000000000000000000000000000000000000000000000000000000281526004018090506020604051808303816000876161da5a03f1156100025750505060405180519060200150600360005060008473ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000508190555061100082610cdb565b8073ffffffffffffffffffffffffffffffffffffffff166383197ef0604051817c01000000000000000000000000000000000000000000000000000000000281526004018090506000604051808303816000876161da5a03f115610002575050505b5050565b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614156110f757600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16ff5b5b566060604052604051610757380380610757833981016040528080518201919060200180519060200190919080519060200190919050505b33600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908302179055508260016000509080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106100b057805160ff19168380011785556100e1565b828001600101855582156100e1579182015b828111156100e05782518260005055916020019190600101906100c2565b5b50905061010c91906100ee565b8082111561010857600081815060009055506001016100ee565b5090565b505081600760005081905550806008600050819055505b505050610623806101346000396000f3606060405236156100b6576000357c01000000000000000000000000000000000000000000000000000000009004806306fdde03146100b857806309eef43e146101335780633197cbb61461015f5780633d79d1c81461018257806361ebccfd146101a557806378e97925146101cf57806383197ef0146101f257806394f0873d14610201578063bd108fd414610224578063bfcddbbc14610247578063d6b225be1461026a578063da58c7d91461028d576100b6565b005b6100c560048050506102cf565b60405180806020018281038252838181518152602001915080519060200190808383829060006004602084601f0104600f02600301f150905090810190601f1680156101255780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6101496004808035906020019091905050610370565b6040518082815260200191505060405180910390f35b61016c60048050506103fb565b6040518082815260200191505060405180910390f35b61018f60048050506103e9565b6040518082815260200191505060405180910390f35b6101cd600480803590602001909190803590602001909190803590602001909190505061040d565b005b6101dc60048050506103f2565b6040518082815260200191505060405180910390f35b6101ff60048050506105c9565b005b61020e600480505061059b565b6040518082815260200191505060405180910390f35b61023160048050506103d7565b6040518082815260200191505060405180910390f35b6102546004805050610404565b6040518082815260200191505060405180910390f35b61027760048050506103e0565b6040518082815260200191505060405180910390f35b6102a36004808035906020019091905050610395565b604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b60016000508054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156103685780601f1061033d57610100808354040283529160200191610368565b820191906000526020600020905b81548152906001019060200180831161034b57829003601f168201915b505050505081565b600260005060205280600052604060002060009150909054906101000a900460ff1681565b600360005081815481101561000257906000526020600020900160005b9150909054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60046000505481565b60056000505481565b60066000505481565b60076000505481565b60086000505481565b60096000505481565b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614151561046957610596565b821561048657816004600082828250540192505081905550610499565b8160056000828282505401925050819055505b6001600260005060008373ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff021916908302179055506003600050805480600101828181548183558181151161052e5781836000526020600020918201910161052d919061050f565b80821115610529576000818150600090555060010161050f565b5090565b5b5050509190906000526020600020900160005b83909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff0219169083021790555050818202600660008282825054019250508190555060096000818150548092919060010191905055505b505050565b600060056000505460046000505411156105bc57600190506105c6566105c5565b600090506105c6565b5b90565b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415610620575b5b56',
			from: web3.eth.accounts[0]
		},
		function(err, myContract) {
			if (!err) {
				// NOTE: The callback will fire twice!
				// Once the contract has the transactionHash property set and once its deployed on an address.

				// e.g. check tx hash on the first call (transaction send)
				if (!myContract.address) {
					// check address on the second call (contract deployed)
				} else {
					console.log(myContract.address)
					var organizationAddress = myContract.address
					//console.log("num", myContract.proposals(0).toString())

					myContract.makeProposal("Buy more beer", moment().add(5, 's').unix(), moment().add(30,'s').unix(), {
						from: web3.eth.accounts[0]
					});
					//console.log("num", myContract.proposals(0).toString())

					myContract.makeProposal("Install solar panels", moment().add(10, 's').unix(), moment().add(1,'day').unix(), {
						from: web3.eth.accounts[0]
					});
					//console.log("num", myContract.proposals(0).toString())

					FlowRouter.go("/orgs/" + organizationAddress + "/proposals")

				}
			} else {
				console.log("Err", err);
				Meteor.disconnect();
			}
		});
	},

	render: function() {

		let {field} = this.state

		return (

			<Col xs={6} xsOffset={3}>
				<form onSubmit={this.onCreateOrganization}>
			        <Input type="text" placeholder="Name the organization" label="Create Organization" value={field} onChange={this.onFieldChange}></Input>
			        <Input type="submit"></Input>
			     </form>  
			</Col>
		);
	}

});